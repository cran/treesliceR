<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to treesliceR</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to treesliceR</h1>



<div id="prelude" class="section level1">
<h1>Prelude</h1>
<p><code>treesliceR</code> is an R package that offers versatile tools
for subsetting and slicing phylogenetic trees at various depths and
orientations. Sliced and pruned phylogenies generated with
<code>treesliceR</code> are readily available for downstream analysis,
facilitating the evaluation of phylogenetic patterns such as alpha and
beta phylogenetic metrics. With <code>treesliceR</code>, phylogenies can
be sliced in different temporal orientations, either “rootwardly” or
“tipwardly”, and internally using diverse temporal criteria such as
million od years, accumulated phylogenetic diversity, or quantiles of
tip ages distribution.</p>
<p>Moreover, <code>treesliceR</code> contains functions for assessing
the rates of accumulation of phylogenetic information (e.g., “α” and “β”
diversities) over time. For a comprehensive introduction to calculating
these metrics, refer to <a href="https://araujomat.github.io/treesliceR/articles/Passeriformes-diversification.html">this
vignette</a>. All analysis are designed to be flexible, reliable, and
efficient, with computationally time-demanding functions optimized for
parallel computation. Additionally, our package includes plotting
functions that enable the production of ready-to-use figures.</p>
<p>To demonstrate the basic usage of <code>treesliceR</code>, we will
provide examples illustrating how to subset and slice phylogenies in
different ways. To begin, it is necessary to load the <code>ape</code>
package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading it</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span></code></pre></div>
<p>Now, we’ll need to load (and install if necessary) the
<code>treesliceR</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading it</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treesliceR)</span></code></pre></div>
<p>To showcase the flexibility of <code>treesliceR</code>, we will
provide a demonstration on how to subset and slice a phylogenetic tree
for passarine species (308 species) included in the package (obatined
from <a href="https://doi.org/10.1038/nature11631">Jetz et
al. (2012)</a>). The <code>pass_tree</code> object comprises a
multiphylo object containing 100 passerine trees. For simplicity, we
will focus on a single tree. To load this dataset, we use the following
code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> pass_trees[[<span class="dv">1</span>]]</span></code></pre></div>
</div>
<div id="prunning-function" class="section level1">
<h1>1. Prunning function</h1>
<p><code>treesliceR</code> encompasses functions for pruning a
phylogenetic tree based on a specific absolute tree depth or by
establishing a quantile value devied from the age distribution of the
last splitting events for the tips of a given phylogenetic tree. In both
procedures (absolute age or quantile), all tips with the age of the last
splitting event <strong>after</strong> or <strong>before</strong> the
value specified in the time argument will be pruned or retained in the
phylogeny (depending on the <code>method</code> argument). In the next
examples, we will illustrate how to prune the phylogenetic tree using an
absolute depth (in this case, in million of years) or a scalar
indicating a quantile drawn from the tip-species age distribution.</p>
<div id="prunning-using-absolute-depth" class="section level2">
<h2>1.1. Prunning using absolute depth</h2>
<p>First, let’s prune the phylogeny to retain only species with
splitting events older than 10 and 30 millions years:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tree_pruned10 <span class="ot">&lt;-</span> <span class="fu">prune_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> <span class="dv">10</span>, <span class="at">qtl =</span> F) <span class="co"># keep species older than 10my</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>tree_pruned30 <span class="ot">&lt;-</span> <span class="fu">prune_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> <span class="dv">30</span>, <span class="at">qtl =</span> F) <span class="co"># keep species older than 30my</span></span></code></pre></div>
<p>Lets check the format of those phylogenetic trees:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="co"># Setting an 1x3 graphical display</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree, <span class="at">main =</span> <span class="st">&quot;All species&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_pruned10, <span class="at">main =</span> <span class="st">&quot;Species older than 10my&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_pruned30, <span class="at">main =</span> <span class="st">&quot;Species older than 30my&quot;</span>, <span class="at">show.tip.label =</span> T); <span class="fu">axisPhylo</span>()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar) <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that only tip-species with the last splitting events older
than 10 and 30 million years were retained in the trees. It is important
to note that the original branch lengths remain unchanged. From left to
right, we have the original phylogeny, the phylogeny containing only
species with the last splitting event older than 10 million years, and
finally, the phylogeny with species where the last branching event is
older than 30 million years (only three species in our example).</p>
<p>Conversely, the inverse procedure can also be done, allowing us to
keep only the species with the last branching event younger than the
<code>time</code> argument by setting the <code>method</code> argument
as 2. Therefore:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tree_pruned10_inverse <span class="ot">&lt;-</span> <span class="fu">prune_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> <span class="dv">10</span>, <span class="at">qtl =</span> F, <span class="at">method =</span> <span class="dv">2</span>) <span class="co"># keep species younger than 10my</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tree_pruned30_inverse <span class="ot">&lt;-</span> <span class="fu">prune_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> <span class="dv">30</span>, <span class="at">qtl =</span> F, <span class="at">method =</span> <span class="dv">2</span>) <span class="co"># keep species younger than 30my</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting phylogenies</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="co"># Setting an 1x3 graphical display</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree, <span class="at">main =</span> <span class="st">&quot;All species&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_pruned10_inverse, <span class="at">main =</span> <span class="st">&quot;Species younger than 10my&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_pruned30_inverse, <span class="at">main =</span> <span class="st">&quot;Species younger than 30my&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar) <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="prunning-using-depth-quantiles" class="section level2">
<h2>1.2. Prunning using depth quantiles</h2>
<p>The same procedure can be applied by setting the <code>time</code>
argument as a scalar indicating the quantile of the distribution of
tip-species ages, given by the time of the last branching event. For
instance, to retain only species with age values younger (lower) than
the ages of 25th quantile of the age distribution of all species, we can
do the following:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tree_pruned25q <span class="ot">&lt;-</span> <span class="fu">prune_tips</span>(tree, <span class="fl">0.25</span>, <span class="at">qtl =</span> T, <span class="at">method =</span> <span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_pruned25q, <span class="at">main =</span> <span class="st">&quot;Species with ages younger than 25th quantile&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that if we aim to retain species with ages younger than the 25th
quantile, the <code>method</code> argument must be set as 2, as
illustrated in the above example. The default value is 1, signifying the
removal of tips with ages younger than the threshold specified in the
<code>time</code> argument.</p>
</div>
</div>
<div id="slicing-functions" class="section level1">
<h1>2. Slicing functions</h1>
<p>The second family of functions present within <code>treesliceR</code>
enables the slicing of phylogeny in vairous ways. In this section, we
will show the flexibility of <code>treesliceR</code> in performing tree
slicing and visualizing the output of these functions.</p>
<div id="slicing-from-the-tips-to-the-root" class="section level2">
<h2>2.1. Slicing from the tips to the root</h2>
<p>The first option to slice phylogenies is by squeezing its branch
lengths from the tips to the root using the function
<code>squeeze_tips()</code>. Squeezing, in this context, refers to
collapsing branch lengths based on a given threshold (tree depth, in
this case, in million years). This function requires providing a
phylogenetic tree and a numeric value indicating the depth at which the
branches will be compressed. For instance, let’s squeeze the passerine
phylogeny at three different ages (10, 30 and 50 million years):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tree_squeeze10 <span class="ot">&lt;-</span> <span class="fu">squeeze_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> <span class="dv">10</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tree_squeeze30 <span class="ot">&lt;-</span> <span class="fu">squeeze_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> <span class="dv">30</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>tree_squeeze50 <span class="ot">&lt;-</span> <span class="fu">squeeze_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> <span class="dv">50</span>)</span></code></pre></div>
<p>We can visualize the phylogeny before and after the squeezing process
to check out the differences:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="co"># Setting an 1x3 graphical display</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_squeeze10, <span class="at">main =</span> <span class="st">&quot;squeezed at 10my&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_squeeze30, <span class="at">main =</span> <span class="st">&quot;Squeezed at 30my&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_squeeze50, <span class="at">main =</span> <span class="st">&quot;Squeezed at 50my&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar) <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is noteworthy that setting the <code>dropNodes</code> argument as
TRUE (default is FALSE) alters the tree structure by removing nodes with
no branch lengths from the original tree. We can check this out by
typing:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tree_squeeze30_drop <span class="ot">&lt;-</span> <span class="fu">squeeze_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> <span class="dv">30</span>, <span class="at">criteria =</span> <span class="st">&quot;my&quot;</span>, <span class="at">dropNodes =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>tree_squeeze30 <span class="co"># full binary tree</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Phylogenetic tree with 308 tips and 307 internal nodes.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tip labels:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Pitta_iris, Pitta_versicolor, Pitta_erythrogaster, Atrichornis_clamosus, Atrichornis_rufescens, Menura_alberti, ...</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rooted; includes branch lengths.</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>tree_squeeze30_drop <span class="co"># tree with nodes dropped</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Phylogenetic tree with 308 tips and 58 internal nodes.</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tip labels:</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Pitta_iris, Pitta_versicolor, Pitta_erythrogaster, Atrichornis_clamosus, Atrichornis_rufescens, Menura_alberti, ...</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rooted; includes branch lengths.</span></span></code></pre></div>
<p>You’ll observe that the <code>tree_squeeze30</code> object forms a
full binary tree (308 species and 307 nodes), while the object
<code>tree_squeeze30_drop</code> is not a binary tree, as nodes younger
than 30 million years were dropped out from the tree.</p>
<p>As mentioned before, the tree can be squeezed using different depths
criteria. Let’s explore this by using accumulated phylogenetic diversity
(PD) over the years to squeeze and plotting all trees to observe the
differences. First, lets assess the total PD available within the
tree:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>PD_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(tree<span class="sc">$</span>edge.length)</span></code></pre></div>
<p>Then, lets squeeze our tips to the point where 10% and 50% of the
total PD was accumulated in the phylogenetic tree:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tree_squeeze10 <span class="ot">&lt;-</span> <span class="fu">squeeze_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> PD_total<span class="sc">/</span><span class="dv">10</span>, <span class="at">criteria =</span> <span class="st">&quot;pd&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>tree_squeeze50 <span class="ot">&lt;-</span> <span class="fu">squeeze_tips</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> PD_total<span class="sc">/</span><span class="dv">2</span>, <span class="at">criteria =</span> <span class="st">&quot;pd&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="co"># Setting an 1x2 graphical display</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_squeeze10, <span class="at">main =</span> <span class="st">&quot;Tree squeezed at 10% PD&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_squeeze50, <span class="at">main =</span> <span class="st">&quot;Tree squeezed at 50% PD&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar) <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="slicing-from-the-root-to-the-tips" class="section level2">
<h2>2.2. Slicing from the root to the tips</h2>
<p>Another option available in <code>treesliceR</code> is the
<code>squeeze_root()</code> function, allowing users to squeeze the
phylogenetic tree from the root to the tips using the same depth
criteria and arguments as demonstrated in the previous section. For
instance, let’s squeeze our passerine phylogeny root to 50 million
years:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tree_root50 <span class="ot">&lt;-</span> <span class="fu">squeeze_root</span>(<span class="at">tree =</span> tree, <span class="at">time =</span> <span class="dv">50</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_root50, <span class="at">main =</span> <span class="st">&quot;Tree sliced rootwardly in 50my&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Notice that the root of the tree now begins at 50 millions of
years.</p>
</div>
<div id="slicing-phylogenies-internally" class="section level2">
<h2>2.3. Slicing phylogenies internally</h2>
<p><code>treesliceR</code> also provides the option to slice phylogenies
internally by using the function <code>squeeze_int()</code>. In this
function, the user must specify two values representing the depth
boundaries of the tree that will be retained (or removed) from the
phylogeny.</p>
<p>For example, if we want to keep only branches of the tree lying
between 30 and 10 million years, we can use the following code:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tree_int <span class="ot">&lt;-</span> <span class="fu">squeeze_int</span>(<span class="at">tree =</span> tree, <span class="at">from =</span> <span class="dv">30</span>, <span class="at">to =</span> <span class="dv">10</span>,)</span></code></pre></div>
<p>Let’s check out the slice of the tree that was retained and compare
it with the original tree:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="co"># Setting an 1x2 graphical display</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree, <span class="at">main =</span> <span class="st">&quot;Original tree&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree_int, <span class="at">main =</span> <span class="st">&quot;Tree slice 10-30my&quot;</span>, <span class="at">show.tip.label =</span> F); <span class="fu">axisPhylo</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar) <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Again, it is essential to note that the absolute depths of the tree
will change, but the internal branch lengths will remain the same as the
original values (except for the ones that were sliced).</p>
<p>That’s all folks!</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Jetz, W., Thomas, G. H., Joy, J. B., Hartmann, K. and Mooers, A. O.
2012. The global diversity of birds in space and time. - Nature
491(7424): 444–448. <a href="https://doi.org/10.1038/nature11631" class="uri">https://doi.org/10.1038/nature11631</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
